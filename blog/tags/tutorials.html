<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="alternate" type="application/rss+xml" href="/PopGen.jl/blog/rss.xml" title="PopGen.jl RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/PopGen.jl/blog/atom.xml" title="PopGen.jl Atom Feed">
<link rel="alternate" type="application/json" href="/PopGen.jl/blog/feed.json" title="PopGen.jl JSON Feed">



<link rel="search" type="application/opensearchdescription+xml" title="PopGen.jl" href="/PopGen.jl/opensearch.xml">

<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><title data-rh="true">One post tagged with &quot;tutorials&quot; | PopGen.jl</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://BioJulia.net/PopGen.jl/blog/tags/tutorials"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="One post tagged with &quot;tutorials&quot; | PopGen.jl"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/PopGen.jl/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://BioJulia.net/PopGen.jl/blog/tags/tutorials"><link data-rh="true" rel="alternate" href="https://BioJulia.net/PopGen.jl/blog/tags/tutorials" hreflang="en"><link data-rh="true" rel="alternate" href="https://BioJulia.net/PopGen.jl/blog/tags/tutorials" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://JASY30KF23-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/PopGen.jl/assets/css/styles.c78473f7.css">
<link rel="preload" href="/PopGen.jl/assets/js/runtime~main.63422a8c.js" as="script">
<link rel="preload" href="/PopGen.jl/assets/js/main.79a063e4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="announcementBarContent_xLdY">üîµ Like PopGen.jl? Give it a ‚≠ê on <a target="_blank" rel="noopener noreferrer" href="https://github.com/BioJulia/PopGen.jl">GitHub!</a>! üü£</div><button type="button" class="clean-btn close announcementBarClose_gvF7" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/PopGen.jl/"><div class="navbar__logo"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">PopGen.jl</b></a><a class="navbar__item navbar__link" href="/PopGen.jl/docs">Docs</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/gettingstarted/quickstart">Quickstart</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/gettingstarted/about">About</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/PopGen.jl/blog">Blog</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/latest">News</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/gettingstarted/community">Get Involved</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/pdimens/popgen.jl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/PopGen.jl/blog/fst">A bit about FST</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/PopGen.jl/blog/relatedness">Relatedness Tutorial</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/PopGen.jl/blog/logos">Logo Graveyard</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>One post tagged with &quot;tutorials&quot;</h1><a href="/PopGen.jl/blog/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/PopGen.jl/blog/relatedness">Relatedness Tutorial</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2020-11-14T00:00:00.000Z" itemprop="datePublished">November 14, 2020</time> ¬∑ <!-- -->11 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/pdimens" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars1.githubusercontent.com/u/19176506?s=460&amp;u=3afad1d1ef3b09ddc4ab7108143f515be3412d5a&amp;v=4" alt="Pavel Dimens"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/pdimens" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Pavel Dimens</span></a></div><small class="avatar__subtitle" itemprop="description">Little this, little that</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>PopGen.jl &lt;0.9.0</div><div class="admonitionContent_S0QG"><p>The kinship interface has changed a bit between versions 0.7 and 0.9. This
post has not yet been updated for versions 0.9.0+. To follow along, use versions 0.8.0 or lower.</p></div></div><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="getting-started">Getting Started<a class="hash-link" href="#getting-started" title="Direct link to heading">‚Äã</a></h2><p>In a population genetics study, you often need to identify if there are kin in your data. This may be necessary because you are trying to remove kin from your data (because of Hardy-Weinberg assumptions), or maybe kinship is a central interest in your study. Either way, the goal of this tutorial is to provide you with a basic tutorial on using PopGen.jl to perform a relatedness analysis, which is sometimes called a <em>kinship</em> analysis. To follow along, you&#x27;ll need to have Julia, along with the packages PopGen.jl, PopGenSims.jl, and StatsBase.jl installed. We&#x27;ll be using the <code>nancycats</code> data because it&#x27;s smaller than <code>gulfsharks</code>, so things should be a lot quicker.</p><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">using</span><span class="token plain"> PopGen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PopGenSims</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> StatsBase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> cats </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> @nancycats</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PopData</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Diploid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> Microsatellite Loci</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Samples</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">237</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Populations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="estimators">Estimators<a class="hash-link" href="#estimators" title="Direct link to heading">‚Äã</a></h3><p>Like <code>Coancestry</code> and the R packages that wrap it (i.e. <code>relate</code>, <code>related</code>), PopGen.jl provides a whole bunch of relatedness estimators that you can choose from for your data. Unfortunately, there is no right answer and you will need to use your discretion. Some people choose an estimator based on the heterozygosity of the data, others choose one based on more liberal or conservative values, and there are yet more criteria one can consider for choosing an estimator. To keep things simple, we&#x27;re going to use <code>LynchLi</code>. Why? Because I&#x27;m the one writing this tutorial, and I said so üòÅ. </p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="the-steps">The Steps<a class="hash-link" href="#the-steps" title="Direct link to heading">‚Äã</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="1-calculate-pairwise-relatedness">1. Calculate pairwise relatedness<a class="hash-link" href="#1-calculate-pairwise-relatedness" title="Direct link to heading">‚Äã</a></h3><p>This seems pretty obvious, but it needs to be said. In order to do the analysis, you need you get the pairwise relatedness values for the individuals of interest in your data. To keep things simple, we&#x27;re going to do an all-by-all comparison. But, we also want to boostrap the pairs to create confidence intervals (&quot;CI&quot;) for each pair, so let&#x27;s talk about that.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="2-bootstrap-to-calculate-ci">2. Bootstrap to calculate CI<a class="hash-link" href="#2-bootstrap-to-calculate-ci" title="Direct link to heading">‚Äã</a></h3><p>It would behoove us to bootstrap the loci in a pairwise comparison <em>n</em> number of times so we can create a confidence interval for the relatedness estimates for each pair. This inflates the runtime of the analysis substantially, but it&#x27;s a very useful method in making sense of our estimates. If one was to be conservative (and we generally are), then we would reject an estimate for a pair whose CI includes zero. In PopGen.jl, the estimates and bootstrapping are done all at once to minimize processing time, so the command for that would be</p><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> rel_out  </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kinship</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cats</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> method </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> LynchLi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> iterations </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>By default, the <code>kinship</code> function uses a 95% CI (<code>interval = (0.025, 0.975)</code>), but you can change that with <code>interval = (low,high)</code> where <code>low</code> and <code>high</code> are decimals of your quantiles.
The <code>kinship()</code> function returns a <code>NamedTuple</code> of dataframes whenever you are bootstrapping, where each element shares its name with the method used, so in this case, we can access our results with <code>rel_out.LynchLi</code>.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">relatedness</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">plotting</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia&gt; rel_out.LynchLi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">27966√ó8 DataFrame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Row ‚îÇ sample_1  sample_2  n_loci  LynchLi     LynchLi_mean  LynchLi_median  LynchLi_S ‚ãØ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       ‚îÇ String    String    Int64   Float64?    Float64?      Float64?        Float64?  ‚ãØ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     1 ‚îÇ N215      N216           8   0.743535      0.747288        0.748042     0.75344 ‚ãØ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     2 ‚îÇ N215      N217           8   0.230605      0.233593        0.240085     0.34187</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     3 ‚îÇ N215      N218           8   0.230605      0.230507        0.221861     0.32161</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     4 ‚îÇ N215      N219           8   0.230605      0.23601         0.23567      0.32782</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     5 ‚îÇ N215      N220           8   0.333191      0.33798         0.350492     0.39898 ‚ãØ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     6 ‚îÇ N215      N221           8   0.589656      0.594223        0.601308     0.61945</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     7 ‚îÇ N215      N222           8   0.0254328     0.0347216       0.0262021    0.21408</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     8 ‚îÇ N215      N223           8   0.333191      0.329983        0.331411     0.38402</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     9 ‚îÇ N215      N224           8  -0.0258602    -0.021062       -0.0301579    0.21112 ‚ãØ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    10 ‚îÇ N215      N7             8  -0.282325     -0.27967        -0.288337     0.33611</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    11 ‚îÇ N215      N141           8  -0.0771532    -0.0796867      -0.083113     0.21261</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    12 ‚îÇ N215      N142           8   0.0254328     0.0302549       0.0330718    0.23957</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ‚ãÆ   ‚îÇ    ‚ãÆ         ‚ãÆ        ‚ãÆ         ‚ãÆ            ‚ãÆ              ‚ãÆ             ‚ãÆ     ‚ã±</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27955 ‚îÇ N295      N289           7   0.322731      0.347021        0.34118      0.41168 ‚ãØ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27956 ‚îÇ N295      N290           7   0.153414      0.160102        0.164866     0.22862</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27957 ‚îÇ N296      N297           7  -0.0159038    -0.0182747      -0.0187108    0.16981</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27958 ‚îÇ N296      N281           7   0.0405353     0.037025        0.0422647    0.15294</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27959 ‚îÇ N296      N289           7   0.322731      0.328379        0.337317     0.35578 ‚ãØ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27960 ‚îÇ N296      N290           7   0.153414      0.152384        0.16194      0.19131</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27961 ‚îÇ N297      N281           7  -0.0159038    -0.0128349      -0.0303449    0.21030</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27962 ‚îÇ N297      N289           7   0.37917       0.392517        0.392818     0.45139</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27963 ‚îÇ N297      N290           7   0.435609      0.437829        0.450044     0.47027 ‚ãØ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27964 ‚îÇ N281      N289           8   0.20428       0.21279         0.207425     0.29611</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27965 ‚îÇ N281      N290           7   0.37917       0.386583        0.390585     0.45471</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 27966 ‚îÇ N289      N290           7   0.209853      0.217811        0.222894     0.28649</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                          2 columns and 27942 rows omitted</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>And while it&#x27;s totally optional, we can plot the distribution of values for some visual data exploration. For that we&#x27;ll use Plots.jl and StatsPlots.jl. </p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>plotting packages</div><div class="admonitionContent_S0QG"><p>We could have used any plotting package, but Plots.jl was chosen for simplicity. Other great
options are (and not limited to): Makie.jl, Gadfly.jl, VegaLite.jl, and PlotlyJS.jl.</p></div></div><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">using</span><span class="token plain"> Plots</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> StatsPlots</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> density</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rel_out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LynchLi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LynchLi</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> title</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;LynchLi relatedness&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="relatedness_histo" src="/PopGen.jl/assets/images/nancycats_LynchLi-8b8fb132d841ad2cdff25f8b4d25c16d.png" width="600" height="400" class="img_ev3q"></p></div></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="3-create-cis-for-the-sibships">3. Create CI&#x27;s for the sibships<a class="hash-link" href="#3-create-cis-for-the-sibships" title="Direct link to heading">‚Äã</a></h3><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>There&#x27;s more???</div><div class="admonitionContent_S0QG"><p>The next set of steps seem like a lot more work, so allow me to explain. The estimators all generally give you some value between 0-1 (or 0-0.5, same idea) and you can intuit that certain values mean certain things, like that <code>0</code> is &quot;unrelated&quot;, <code>0.25</code> is &quot;half-sib&quot;, and <code>0.5</code> is &quot;full-sib&quot;. However, those are fixed values, so how do we know how far we can deviate from 0.25 (for example) and still call our pair half-siblings? Instead of hand-waving, we can create confidence intervals from simulated data to act as sibship ranges for our data. If this doesn&#x27;t make sense yet, it will below. Promise! </p></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="i-simulate-known-sibship-pairs">i. simulate known sibship pairs<a class="hash-link" href="#i-simulate-known-sibship-pairs" title="Direct link to heading">‚Äã</a></h4><p>Next, we need to further contextualize what out estimates actually mean, and we need to devise a rigorous and defensible method to define the sibling-ship (&quot;sibship&quot;) of a pair of samples as <strong>unrelated</strong>, <strong>half-sibs</strong>, or <strong>full-sibs</strong>. To do this, we&#x27;re going to use PopGenSims.jl to simulate data based on the allele frequencies in our data. What <code>simulatekin</code> does is simulate individuals based on the allele frequencies in your <code>PopData</code>, then simulate offspring of a particular siblingship resulting from the &quot;mating&quot; of those individuals. For example, when you specify <code>&quot;fullsib&quot;</code>, it generates two offspring resulting from two parents, <code>n</code> number of times. We want to do this for each of the three kinds of sibships.</p><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> kin_sims </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> simulatekin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cats</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fullsib </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> halfsib </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> unrelated </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PopData</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">Diploid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> Microsatellite Loci</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Samples</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Populations</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>We can keep all three simulated relationships together, but it will be easier to explain things (for instructional purposes) if we don&#x27;t, so let&#x27;s split out each into its own PopData.</p><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> fullsib </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kin_sims</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">genodata</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kin_sims</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">population </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fullsib&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> halfsib </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kin_sims</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">genodata</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kin_sims</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">population </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;halfsib&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> unrelated </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kin_sims</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">genodata</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kin_sims</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">population </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;unrelated&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="ii-get-relatedness-estimates-for-the-simulated-data">ii. get relatedness estimates for the simulated data<a class="hash-link" href="#ii-get-relatedness-estimates-for-the-simulated-data" title="Direct link to heading">‚Äã</a></h4><p>Next, we want to get the relatedness estimate for each simulated pair of &quot;known&quot; sibship. We are only interested in the values for the simulated pairs and not samples across pairs. If you aren&#x27;t sure why that is, think of it this way: we&#x27;re trying to create a range of values where we can confidently say unknown things are full-sibs (or half-sib, etc.), so we want to know what range of values we get from a bunch of known fullsib pairs, not the unknown relationships of samples between pairs. </p><p>It would a nightmare to manually specify only 2 individuals at a time into <code>kinship()</code>. Instead, the function has a shortcut built into it that will recognize the <code>population</code> names generated from <code>simulatekin</code> and only give you relatedness estimates for those pairs. So, we just need to run it once for each of our simulations, this time <em>without</em> bootstrapping because we are only interested in the estimates. Make sure to use the same estimator! The run will be a lot faster this time because it only needs to calculate estimates for 500 pairs each time (our <code>n</code> from above) and without bootstrapping. When not bootstrapping, <code>kinship()</code> returns a dataframe (versus a NamedTuple of dataframes).</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">unrelated relatedness</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">halfsib relatedness</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">fullsib relatedness</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> un_sims_rel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kinship</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">unrelated_sims</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> method </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> LynchLi</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">500</span><span class="token plain">√ó</span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> DataFrame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Row ‚îÇ sample_1            sample_2            n_loci  LynchLi    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ‚îÇ String              String              Int64   Float64</span><span class="token punctuation" style="color:#393A34">?</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> ‚îÇ sim001_unrelated_1  sim001_unrelated_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.11419</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> ‚îÇ sim002_unrelated_1  sim002_unrelated_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.337028</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> ‚îÇ sim003_unrelated_1  sim003_unrelated_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.0696222</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ‚ãÆ  ‚îÇ         ‚ãÆ                   ‚ãÆ             ‚ãÆ         ‚ãÆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">498</span><span class="token plain"> ‚îÇ sim498_unrelated_1  sim498_unrelated_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.019513</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">499</span><span class="token plain"> ‚îÇ sim499_unrelated_1  sim499_unrelated_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.019513</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain"> ‚îÇ sim500_unrelated_1  sim500_unrelated_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.019513</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  </span><span class="token number" style="color:#36acaa">494</span><span class="token plain"> rows omitted</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> half_sims_rel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kinship</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">halfsib_sims</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> method </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> LynchLi</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">500</span><span class="token plain">√ó</span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> DataFrame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Row ‚îÇ sample_1          sample_2          n_loci  LynchLi    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ‚îÇ String            String            Int64   Float64</span><span class="token punctuation" style="color:#393A34">?</span><span class="token plain">   </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> ‚îÇ sim001_halfsib_1  sim001_halfsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.0182636</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> ‚îÇ sim002_halfsib_1  sim002_halfsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.468732</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> ‚îÇ sim003_halfsib_1  sim003_halfsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.291643</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ‚ãÆ  ‚îÇ        ‚ãÆ                 ‚ãÆ            ‚ãÆ         ‚ãÆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">498</span><span class="token plain"> ‚îÇ sim498_halfsib_1  sim498_halfsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.42446</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">499</span><span class="token plain"> ‚îÇ sim499_halfsib_1  sim499_halfsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.513004</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain"> ‚îÇ sim500_halfsib_1  sim500_halfsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">0.0702811</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                              </span><span class="token number" style="color:#36acaa">494</span><span class="token plain"> rows omitted</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> full_sims_rel </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kinship</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">fullsib_sims</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> method </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> LynchLi</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">500</span><span class="token plain">√ó</span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> DataFrame</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Row ‚îÇ sample_1          sample_2          n_loci  LynchLi  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ‚îÇ String            String            Int64   Float64</span><span class="token punctuation" style="color:#393A34">?</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> ‚îÇ sim001_fullsib_1  sim001_fullsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.732808</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> ‚îÇ sim002_fullsib_1  sim002_fullsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.599213</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token number" style="color:#36acaa">3</span><span class="token plain"> ‚îÇ sim003_fullsib_1  sim003_fullsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.376553</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ‚ãÆ  ‚îÇ        ‚ãÆ                 ‚ãÆ            ‚ãÆ        ‚ãÆ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">498</span><span class="token plain"> ‚îÇ sim498_fullsib_1  sim498_fullsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.376553</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">499</span><span class="token plain"> ‚îÇ sim499_fullsib_1  sim499_fullsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.510149</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">500</span><span class="token plain"> ‚îÇ sim500_fullsib_1  sim500_fullsib_2       </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0.109361</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                            </span><span class="token number" style="color:#36acaa">494</span><span class="token plain"> rows omitted</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>And if we wanted to plot what that looks like (optional):</p><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">using</span><span class="token plain"> Plots</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> StatsPlots</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> density</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rel_out</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LynchLi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LynchLi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;real data&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">grey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> fill </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">grey</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> density</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">un_sims_rel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LynchLi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;unrelated&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> density</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">half_sims_rel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LynchLi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;halfsib&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">blue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> density</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">full_sims_rel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LynchLi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> label </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;fullsib&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> color </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">black</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> title</span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;relatedness estimates on simulated and real data&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" alt="relatedness_histo" src="/PopGen.jl/assets/images/nancycats_sims-d891d2c0c1dcf2f3fb45784ca0664959.png" width="600" height="400" class="img_ev3q"></p><p>Hopefully by now you are starting to contextualize why we&#x27;re doing all of this. The distributions generated from our simulated data are giving us a better indication of what &quot;unrelated&quot;, &quot;halfsib&quot;, and &quot;fullsib&quot; estimates look like in our data.</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="iii-sibship-intervals">iii. sibship intervals<a class="hash-link" href="#iii-sibship-intervals" title="Direct link to heading">‚Äã</a></h4><p>What we just did is create null distributions for each sibship relationship, so now all that&#x27;s left is to get a confidence interval from each. Keep in mind that your values will be a bit different due to the randomization involved with many of these steps.</p><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> unrelated_ci </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> quantile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">un_sims_rel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LynchLi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.025</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.975</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.3380513384854698</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.33097433075726507</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> halfsibs_ci </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> quantile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">half_sims_rel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LynchLi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.025</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.975</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.06652262584414452</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5556155725649398</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> fullsibs_ci </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> quantile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">full_sims_rel</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LynchLi</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.025</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.975</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.1989727186688347</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.8219939374819633</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>So, given our data and the simulations we made, we can now make a reasonable assumption regarding the ranges for each sibship relationship:</p><table><thead><tr><th align="left">Relationship</th><th align="center">Lower Bound</th><th align="center">Upper Bound</th></tr></thead><tbody><tr><td align="left">unrelated</td><td align="center">-0.338</td><td align="center">0.331</td></tr><tr><td align="left">half sibling</td><td align="center">-0.066</td><td align="center">0.555</td></tr><tr><td align="left">full sibling</td><td align="center">0.199</td><td align="center">0.82</td></tr></tbody></table><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="4-finally-the-data-assessment">4. Finally, the data assessment<a class="hash-link" href="#4-finally-the-data-assessment" title="Direct link to heading">‚Äã</a></h3><p>Now that we have our relatedness estimates and the acceptable sibship ranges given our data, we can see where our data falls.
<em>Now</em>, we can say that a particular sample pair is unrelated/halfsib/fullsib if:</p><ol><li>that pair&#x27;s confidence interval does not include zero and </li><li>that pair&#x27;s estimate falls within any of the three calculate ranges</li></ol><p>Unfortunately, the ranges overlap quite a bit, which makes interpretation difficult, so it may be suitable to use a different estimator. </p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="closing-remarks">Closing remarks<a class="hash-link" href="#closing-remarks" title="Direct link to heading">‚Äã</a></h3><p>There is more that can be done for relatedness, like network analysis. However, this tutorial covers what we consider a reasonable way to assess kinship in population genetic studies. If removing kin is your ultimate goal, consider the effects doing that may have on the analyses you are looking to do. Additionally, consider which individual of a pair you would remove and why. If you were curious as to how many identical loci a pair of samples may share, you can check that using <code>pairwiseidentical()</code>. Good luck!</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/PopGen.jl/blog/tags/tutorials">tutorials</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 Pavel Dimens & Jason Selwyn. Built with Docusaurus. Rawr!</div></div></div></footer></div>
<script src="/PopGen.jl/assets/js/runtime~main.63422a8c.js"></script>
<script src="/PopGen.jl/assets/js/main.79a063e4.js"></script>
</body>
</html>