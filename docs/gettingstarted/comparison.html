<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-gettingstarted/comparison">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="alternate" type="application/rss+xml" href="/PopGen.jl/blog/rss.xml" title="PopGen.jl RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/PopGen.jl/blog/atom.xml" title="PopGen.jl Atom Feed">
<link rel="alternate" type="application/json" href="/PopGen.jl/blog/feed.json" title="PopGen.jl JSON Feed">



<link rel="search" type="application/opensearchdescription+xml" title="PopGen.jl" href="/PopGen.jl/opensearch.xml">

<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><title data-rh="true">Comparison | PopGen.jl</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://BioJulia.net/PopGen.jl/docs/gettingstarted/comparison"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Comparison | PopGen.jl"><meta data-rh="true" name="description" content="There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:"><meta data-rh="true" property="og:description" content="There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:"><link data-rh="true" rel="icon" href="/PopGen.jl/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://BioJulia.net/PopGen.jl/docs/gettingstarted/comparison"><link data-rh="true" rel="alternate" href="https://BioJulia.net/PopGen.jl/docs/gettingstarted/comparison" hreflang="en"><link data-rh="true" rel="alternate" href="https://BioJulia.net/PopGen.jl/docs/gettingstarted/comparison" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://JASY30KF23-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/PopGen.jl/assets/css/styles.c78473f7.css">
<link rel="preload" href="/PopGen.jl/assets/js/runtime~main.c5313cc4.js" as="script">
<link rel="preload" href="/PopGen.jl/assets/js/main.71020cbe.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="announcementBar_mb4j" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="announcementBarContent_xLdY">üîµ Like PopGen.jl? Give it a ‚≠ê on <a target="_blank" rel="noopener noreferrer" href="https://github.com/BioJulia/PopGen.jl">GitHub!</a>! üü£</div><button type="button" class="clean-btn close announcementBarClose_gvF7" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/PopGen.jl/"><div class="navbar__logo"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">PopGen.jl</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/PopGen.jl/docs">Docs</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/gettingstarted/quickstart">Quickstart</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/gettingstarted/about">About</a><a class="navbar__item navbar__link" href="/PopGen.jl/blog">Blog</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/latest">News</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/gettingstarted/community">Get Involved</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/pdimens/popgen.jl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/PopGen.jl/"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_ToTc themedImage--dark_i4oU"><b>PopGen.jl</b></a><nav class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/PopGen.jl/docs">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/gettingstarted/juliaprimer">A quick Julia primer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/gettingstarted/tips">PopGen.jl tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/PopGen.jl/docs/gettingstarted/comparison">Comparison</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/gettingstarted/datasets">Provided datasets</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/PopGen.jl/docs/io/readwrite">File I/O</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/PopGen.jl/docs/popdata">Working with PopData</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/PopGen.jl/docs/analyses/hardyweinberg">Analyses</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/PopGen.jl/docs/simulations">Simulations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/PopGen.jl/docs/api">API</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/PopGen.jl/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Getting Started</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Comparison</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Comparison</h1></header><p>There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:</p><ol><li>fast(er)</li><li>written in a single language</li><li>easy to use</li></ol><p>So, we&#x27;d like to prove that Julia and PopGen.jl actually achieves that by showing a few benchmarks comparing PopGen.jl to popular population genetics packages in R. It&#x27;s worth mentioning that we ourselves use and have published work incorporating these packages, and are incredibly grateful for the work invested in them. We appreciate those folks and have tremendous respect and envy for the work they continue to do! Here are links to <a href="https://github.com/thibautjombart/adegenet" target="_blank" rel="noopener noreferrer">adegenet</a>, <a href="https://academic.oup.com/bioinformatics/article/26/3/419/215731/" target="_blank" rel="noopener noreferrer">pegas</a>, <a href="https://cran.r-project.org/web/packages/hierfstat/index.html" target="_blank" rel="noopener noreferrer">hierfstat</a>, and <a href="https://cran.r-project.org/package=ape" target="_blank" rel="noopener noreferrer">ape</a>.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="benchmarks">Benchmarks<a class="hash-link" href="#benchmarks" title="Direct link to heading">‚Äã</a></h2><p>To make this a practical comparison, we&#x27;re going to use the <code>gulfsharks</code> data because it is considerably larger (212 samples x 2209 loci) than <code>nancycats</code> (237 x 9) and a bit more of a &quot;stress test&quot;.  All benchmarks in R are performed using the <code>microbenchmark</code> package, and  <code>BenchmarkTools</code> are used for Julia.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">load Julia packages</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">load R packages</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">using</span><span class="token plain"> BenchmarkTools</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> PopGen</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">library</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">adegenet</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pegas</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hierfstat</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">microbenchmark</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p>As a note, the reported benchmarks are being performed on a 64-bit Manjaro Linux system on a nothing-special Lenovo Thinkbook 14S  with 8gigs of RAM and a 8th gen Intel i5 mobile processor. <strong>Note:</strong> all of the Julia benchmarks, unless explicitly stated, are performed single-threaded (i.e. not parallel, distributed, or GPU).</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="reading-in-data">Reading in data<a class="hash-link" href="#reading-in-data" title="Direct link to heading">‚Äã</a></h3><p>Since <code>gulfsharks</code> is provided in PopGenCore.jl, we will just load it with <code>genepop()</code>.  If you would like to try this yourself in R, find the <code>gulfsharks.gen</code> file in the package repository under <code>/data/source/gulfsharks.gen</code>. Since the file importer now uses CSV.jl to read files, there is one step of the genepop parser that is multithreaded. However, the majority of the data parsing (formatting the raw data into a correct PopData structure) occurs using a single thread. This R benchmark will take a few minutes. Consider making some tea while you wait.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Julia</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">R</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@benchmark sharks = genepop(&quot;data/source/gulfsharks.gen&quot;, silent = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools.Trial: 10 samples with 1 evaluation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Range (min ‚Ä¶ max):  472.671 ms ‚Ä¶ 526.777 ms  ‚îä GC (min ‚Ä¶ max): 0.00% ‚Ä¶ 5.75%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Time  (median):     507.187 ms               ‚îä GC (median):    5.00%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Time  (mean ¬± œÉ):   501.984 ms ¬±  17.301 ms  ‚îä GC (mean ¬± œÉ):  3.47% ¬± 2.99%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ‚ñÅ          ‚ñÅ     ‚ñÅ   ‚ñÅ            ‚ñÅ        ‚ñÅ ‚ñà   ‚ñÅ          ‚ñÅ  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñà‚ñÅ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñà‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñà ‚ñÅ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  473 ms           Histogram: frequency by time          527 ms &lt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Memory estimate: 172.46 MiB, allocs estimate: 2246870.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> microbenchmark</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">read.genepop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/home/pdimens/gulfsharks.gen&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ncode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> quiet </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unit</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> read.genepop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/home/pdimens/gulfsharks.gen&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ncode </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3L</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> quiet </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">FALSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      min       lq     mean   median       uq      max neval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">5.670637</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6.218719</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6.745065</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6.387936</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7.019667</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9.173005</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">microbenchmark</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p><img loading="lazy" alt="import plot" src="/PopGen.jl/assets/images/speedplot-a0dcb588e1923961a9aaf9e183490011.png" width="745" height="372" class="img_ev3q"></p><p>Comparing averages, Julia (via PopGen.jl) clocks in at <code>507ms</code> versus R (via adegenet) at <code>6.745s</code> , so ~13.3x faster.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="popdata-vs-genind-size"><code>PopData</code> vs <code>genind</code> size<a class="hash-link" href="#popdata-vs-genind-size" title="Direct link to heading">‚Äã</a></h3><p>It was pretty tricky to come up with a sensible/efficient/convenient data structure for PopGen.jl, and while the two-DataFrames design might not seem like it took a lot of effort, we ultimately decided that the column-major style and available tools, combined with careful genotype Typing was a decent &quot;middle-ground&quot; of ease-of-use vs performance.</p><p><em>Anyway</em>, it&#x27;s important to understand how much space your data will take up in memory (your RAM) when you load it in, especially since data&#x27;s only getting bigger! Keep in mind that <code>gulfsharks</code> in PopGen.jl also provides lat/long data, which <em>should</em> inflate the size of the object somewhat compared to the <code>genind</code>, which we won&#x27;t add any location data to.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Julia</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">R</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> Base</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">summarysize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sharks</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">3452870</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#bytes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> object.size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5331536</span><span class="token plain"> bytes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p><img loading="lazy" alt="data structure plot" src="/PopGen.jl/assets/images/objectplot-ec422864760c5133e262eec866a62f7c.png" width="759" height="376" class="img_ev3q"></p><p>The original genepop file is <code>3.2mb</code> (the vertical line), and our <code>PopData</code> object takes up ~<code>3.45mb</code> in memory (300kb larger than the source file) versus the ~<code>5.3mb</code> of a <code>genind</code>, which is ~1.5x larger than the source file. That&#x27;s quite a big difference!</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="summary-statistics">Summary statistics<a class="hash-link" href="#summary-statistics" title="Direct link to heading">‚Äã</a></h3><p>The obvious hallmark of population genetics is heterozygosity values and F-statistics. Here we&#x27;ll compare the basic summary statistics that can be produced using <code>hierfstat</code> and <code>PopGen.jl</code>.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Julia</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">R</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> @benchmark summary</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sharks</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> by </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;global&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Trial</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  memory estimate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">88.42</span><span class="token plain"> MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1307128</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  minimum time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">151.963</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.00</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  median time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">171.484</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">7.60</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mean time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">172.456</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6.08</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  maximum time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">186.606</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">7.04</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  samples</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  evals</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> microbenchmark</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">basic.stats</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unit</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             expr      min       lq     mean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> basic.stats</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gen</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4.276996</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4.425934</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4.618796</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   median       uq      max neval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">4.609901</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4.706666</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5.292831</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p><img loading="lazy" alt="summary statistics plot" src="/PopGen.jl/assets/images/sumstatplot-598f7c700e09791e891c6f574ce057fc.png" width="744" height="372" class="img_ev3q"></p><p>Comparing averages, PopGen.jl clocks in at ~<code>171ms</code> versus hierfstat&#x27;s <code>4.6s</code>, which is ~<strong>27x</strong> faster on these data. However, when testing on a data that was 401 samples x 5331 loci (not shown), PopGen.jl performed 36.6x faster. This gap seems to increase the larger the data is, but we have not tested the upper limits of this.</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="chi-squared-test-for-hwe">Chi-squared test for HWE<a class="hash-link" href="#chi-squared-test-for-hwe" title="Direct link to heading">‚Äã</a></h3><p>This is a classic population genetics test and a relatively simple one. The R benchmark will take a while again, so if you&#x27;re following along, this would be a good time to reconnect with an old friend.</p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Julia</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">R</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> @benchmark hwe_test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sharks</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Trial</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  memory estimate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">46.22</span><span class="token plain"> MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1050525</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  minimum time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">145.476</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.00</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  median time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">179.146</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4.35</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mean time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">176.142</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3.56</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  maximum time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">204.813</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.00</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  samples</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          </span><span class="token number" style="color:#36acaa">29</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  evals</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> microbenchmark</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hw.test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unit</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                expr      min       lq     mean   median       uq      max neval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> hw.test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5.100298</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5.564807</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6.265948</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5.878842</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6.917006</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8.815179</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p><img loading="lazy" alt="chi squared plot" src="/PopGen.jl/assets/images/chisqplot-94c0d817b3b77543f63ae472bbde4d6a.png" width="745" height="372" class="img_ev3q"></p><p>Comparing averages, PopGen.jl clocks in at ~<code>176ms</code> versus adegenet&#x27;s <code>6.3s</code>, so ~<strong>35.8x</strong> faster on these data(!)</p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pairwise-fst">Pairwise FST<a class="hash-link" href="#pairwise-fst" title="Direct link to heading">‚Äã</a></h3><p>You all know it, you all love it. What&#x27;s population genetics without a little pairwise FST sprinkled in? This benchmark compairs the Weir &amp; Cockerham pairwise FST calculation in <code>PopGen.jl</code> against <code>hierfstat</code></p><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Julia</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Julia (parallel)</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">R</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><p>We will add the extra keywords <code>samples</code> and <code>seconds</code> to the benchmark
macro so we can get a full 100 evaluations. You will need to start Julia with 1 available threads via <code>julia --threads 1</code> (julia &gt;= v1.5) or <code>JULIA_NUM_THREADS=1</code> (&lt; v1.5).</p><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> @benchmark pairwise_fst</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sharks</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> samples </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> seconds </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">700</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Trial</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  memory estimate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">869.93</span><span class="token plain"> MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">6090633</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  minimum time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">557.995</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">9.29</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  median time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">571.297</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">11.26</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mean time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">580.627</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">12.59</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  maximum time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">754.451</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">31.41</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  samples</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  evals</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>This is to demonstrate what the speed is like when starting Julia with 4 available threads via <code>julia --threads 6</code> (julia &gt;= v1.5) or <code>JULIA_NUM_THREADS=6</code> (&lt; v1.5).</p><div class="language-julia codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-julia codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">julia</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> @benchmark pairwise_fst</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sharks</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> samples </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"> seconds </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">700</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Trial</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  memory estimate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">869.93</span><span class="token plain"> MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">6090639</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  minimum time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">205.038</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.00</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  median time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token number" style="color:#36acaa">305.189</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">28.90</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mean time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">        </span><span class="token number" style="color:#36acaa">299.227</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">25.03</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  maximum time</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">359.663</span><span class="token plain"> ms </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">27.05</span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> GC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  samples</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">          </span><span class="token number" style="color:#36acaa">100</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  evals</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">     </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>We&#x27;ll need to convert <code>sharks</code> into the matrix/dataframe <code>hierfstat</code> needs
to run this calculation. The conversion will be a separate step so as not
to add unnecessary (or unfair) overhead to the benchmark. This benchmark is
going to take <strong>forever</strong> (200s/run x 100 runs = 5.5hrs), so if you absolutely insist on
trying it out yourself, you may want to pop outside and enjoy some fresh
air for a bit (I ran it overnight). Seriously, you don&#x27;t want to watch this paint dry üñåÔ∏è.</p><div class="language-r codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-r codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> sharks_hierf </span><span class="token operator" style="color:#393A34">&lt;-</span><span class="token plain"> genind2hierfstat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sharks</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> microbenchmark</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pairwise.WCfst</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sharks_hierf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unit</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    expr      min       lq     mean   median       uq      max neval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pairwise.WCfst</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sharks2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">192.2786</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">192.9277</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">199.4861</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">193.5743</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">195.0079</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">301.6879</span><span class="token plain">   </span><span class="token number" style="color:#36acaa">100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><p><img loading="lazy" alt="pairwise fst plot" src="/PopGen.jl/assets/images/fstplot-6a672cb5538833892ee7eda34c33645a.png" width="835" height="372" class="img_ev3q"></p><p>On a single thread, pairwise FST in <code>PopGen.jl</code> is <strong>~340x</strong> faster than in <code>hierfstat</code>, and a whopping <strong>665x</strong> faster using 6 threads with the optimized matrix-based implementation.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/BioJulia/PopGen.jl/edit/documentation/docs/gettingstarted/comparison.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-10-28T20:10:05.000Z">Oct 28, 2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/PopGen.jl/docs/gettingstarted/tips"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">PopGen.jl tips</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/PopGen.jl/docs/gettingstarted/datasets"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Provided datasets</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#benchmarks" class="table-of-contents__link toc-highlight">Benchmarks</a><ul><li><a href="#reading-in-data" class="table-of-contents__link toc-highlight">Reading in data</a></li><li><a href="#popdata-vs-genind-size" class="table-of-contents__link toc-highlight"><code>PopData</code> vs <code>genind</code> size</a></li><li><a href="#summary-statistics" class="table-of-contents__link toc-highlight">Summary statistics</a></li><li><a href="#chi-squared-test-for-hwe" class="table-of-contents__link toc-highlight">Chi-squared test for HWE</a></li><li><a href="#pairwise-fst" class="table-of-contents__link toc-highlight">Pairwise FST</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 Pavel Dimens & Jason Selwyn. Built with Docusaurus. Rawr!</div></div></div></footer></div>
<script src="/PopGen.jl/assets/js/runtime~main.c5313cc4.js"></script>
<script src="/PopGen.jl/assets/js/main.71020cbe.js"></script>
</body>
</html>