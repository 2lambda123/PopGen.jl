<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="alternate" type="application/rss+xml" href="/PopGen.jl/blog/rss.xml" title="PopGen.jl RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/PopGen.jl/blog/atom.xml" title="PopGen.jl Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="PopGen.jl" href="/PopGen.jl/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><title data-react-helmet="true">Comparison | PopGen.jl</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://BioJulia.net/PopGen.jl/docs/gettingstarted/comparison"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Comparison | PopGen.jl"><meta data-react-helmet="true" name="description" content="There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:"><meta data-react-helmet="true" property="og:description" content="There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:"><link data-react-helmet="true" rel="shortcut icon" href="/PopGen.jl/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://BioJulia.net/PopGen.jl/docs/gettingstarted/comparison"><link data-react-helmet="true" rel="alternate" href="https://BioJulia.net/PopGen.jl/docs/gettingstarted/comparison" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://BioJulia.net/PopGen.jl/docs/gettingstarted/comparison" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/PopGen.jl/assets/css/styles.d399e20a.css">
<link rel="preload" href="/PopGen.jl/assets/js/runtime~main.53906080.js" as="script">
<link rel="preload" href="/PopGen.jl/assets/js/main.d608e6a1.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">🔵 Like PopGen.jl? Give it a ⭐ on <a target="_blank" rel="noopener noreferrer" href="https://github.com/BioJulia/PopGen.jl">GitHub!</a>! 🟣</div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_RReh"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/PopGen.jl/"><div class="navbar__logo"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">PopGen.jl</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/PopGen.jl/docs">Docs</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/gettingstarted/quickstart">Quickstart</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/gettingstarted/about">About</a><a class="navbar__item navbar__link" href="/PopGen.jl/blog">Blog</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/latest">News</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/gettingstarted/community">Get Involved</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/pdimens/popgen.jl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_NKBi"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0 sidebarWithHideableNavbar_VlPv"><a tabindex="-1" class="sidebarLogo_hmkv" href="/PopGen.jl/"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo" class="themedImage_TMUO themedImage--dark_uzRr"><b>PopGen.jl</b></a><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Getting Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/gettingstarted/juliaprimer">A quick Julia primer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/gettingstarted/tips">PopGen.jl tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/PopGen.jl/docs/gettingstarted/comparison">Comparison</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/gettingstarted/popdata">The PopData type</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/gettingstarted/othertypes">Other data types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/gettingstarted/datasets">Provided datasets</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">File I/O</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Working with PopData</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Analyses</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Simulations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">API</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Comparison</h1></header><p>There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:</p><ol><li>fast(er)</li><li>written in a single language</li><li>easy to use</li></ol><p>So, we&#x27;d like to prove that Julia and PopGen.jl actually achieves that by showing a few benchmarks comparing PopGen.jl to popular population genetics packages in R. It&#x27;s worth mentioning that we ourselves use and have published work incorporating these packages, and are incredibly grateful for the work invested in them. We appreciate those folks and have tremendous respect and envy for the work they continue to do! Here are links to <a href="https://github.com/thibautjombart/adegenet" target="_blank" rel="noopener noreferrer">adegenet</a>, <a href="https://academic.oup.com/bioinformatics/article/26/3/419/215731/" target="_blank" rel="noopener noreferrer">pegas</a>, <a href="https://cran.r-project.org/web/packages/hierfstat/index.html" target="_blank" rel="noopener noreferrer">hierfstat</a>, and <a href="https://cran.r-project.org/package=ape" target="_blank" rel="noopener noreferrer">ape</a>.  </p><h2 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="benchmarks">Benchmarks<a aria-hidden="true" class="hash-link" href="#benchmarks" title="Direct link to heading">​</a></h2><p>To make this a practical comparison, we&#x27;re going to use the <code>gulfsharks</code> data because it is considerably larger (212 samples x 2209 loci) than <code>nancycats</code> (237 x 9) and a bit more of a &quot;stress test&quot;.  All benchmarks in R are performed using the <code>microbenchmark</code> package, and  <code>BenchmarkTools</code> are used for Julia.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_vU9c tabs__item--active">load Julia packages</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">load R packages</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI julia"><pre tabindex="0" class="prism-code language-julia codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">using BenchmarkTools, PopGen</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI r"><pre tabindex="0" class="prism-code language-r codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">library(adegenet)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library(pegas)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library(hierfstat)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">library(microbenchmark)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></div></div><p>As a note, the reported benchmarks are being performed on a 64-bit Manjaro Linux system on a nothing-special Lenovo Thinkbook 14S  with 8gigs of RAM and a 8th gen Intel i5 mobile processor. <strong>Note:</strong> all of the Julia benchmarks, unless explicitly stated, are performed single-threaded (i.e. not parallel, distributed, or GPU).</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="reading-in-data">Reading in data<a aria-hidden="true" class="hash-link" href="#reading-in-data" title="Direct link to heading">​</a></h3><p>Since <code>gulfsharks</code> is provided in PopGenCore.jl, we will just load it with <code>genepop()</code>.  If you would like to try this yourself in R, find the <code>gulfsharks.gen</code> file in the package repository under <code>/data/source/gulfsharks.gen</code>. Since the file importer now uses CSV.jl to read files, there is one step of the genepop parser that is multithreaded. However, the majority of the data parsing (formatting the raw data into a correct PopData structure) occurs using a single thread. This R benchmark will take a few minutes. Consider making some tea while you wait.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_vU9c tabs__item--active">Julia</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">R</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@benchmark sharks = genepop(&quot;data/source/gulfsharks.gen&quot;, silent = true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools.Trial: 10 samples with 1 evaluation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Range (min … max):  472.671 ms … 526.777 ms  ┊ GC (min … max): 0.00% … 5.75%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Time  (median):     507.187 ms               ┊ GC (median):    5.00%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Time  (mean ± σ):   501.984 ms ±  17.301 ms  ┊ GC (mean ± σ):  3.47% ± 2.99%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ▁          ▁     ▁   ▁            ▁        ▁ █   ▁          ▁  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  █▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁█▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁█▁█▁▁▁█▁▁▁▁▁▁▁▁▁▁█ ▁</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  473 ms           Histogram: frequency by time          527 ms &lt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Memory estimate: 172.46 MiB, allocs estimate: 2246870.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI r"><pre tabindex="0" class="prism-code language-r codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; microbenchmark(read.genepop(file = &quot;/home/pdimens/gulfsharks.gen&quot;, ncode = 3L, quiet = TRUE))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unit: seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> read.genepop(file = &quot;/home/pdimens/gulfsharks.gen&quot;, ncode = 3L, quiet = FALSE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      min       lq     mean   median       uq      max neval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 5.670637 6.218719 6.745065 6.387936 7.019667 9.173005   100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">microbenchmark)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></div></div><p><img alt="import plot" src="/PopGen.jl/assets/images/speedplot-a0dcb588e1923961a9aaf9e183490011.png"></p><p>Comparing averages, Julia (via PopGen.jl) clocks in at <code>507ms</code> versus R (via adegenet) at <code>6.745s</code> , so ~13.3x faster.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="popdata-vs-genind-size"><code>PopData</code> vs <code>genind</code> size<a aria-hidden="true" class="hash-link" href="#popdata-vs-genind-size" title="Direct link to heading">​</a></h3><p>It was pretty tricky to come up with a sensible/efficient/convenient data structure for PopGen.jl, and while the two-DataFrames design might not seem like it took a lot of effort, we ultimately decided that the column-major style and available tools, combined with careful genotype Typing was a decent &quot;middle-ground&quot; of ease-of-use vs performance.</p><p><em>Anyway</em>, it&#x27;s important to understand how much space your data will take up in memory (your RAM) when you load it in, especially since data&#x27;s only getting bigger! Keep in mind that <code>gulfsharks</code> in PopGen.jl also provides lat/long data, which <em>should</em> inflate the size of the object somewhat compared to the <code>genind</code>, which we won&#x27;t add any location data to.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_vU9c tabs__item--active">Julia</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">R</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI julia"><pre tabindex="0" class="prism-code language-julia codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">julia&gt; Base.summarysize(sharks)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3452870</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#bytes</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI r"><pre tabindex="0" class="prism-code language-r codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; object.size(gen)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5331536 bytes</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></div></div><p><img alt="data structure plot" src="/PopGen.jl/assets/images/objectplot-ec422864760c5133e262eec866a62f7c.png"></p><p>The original genepop file is <code>3.2mb</code> (the vertical line), and our <code>PopData</code> object takes up ~<code>3.45mb</code> in memory (300kb larger than the source file) versus the ~<code>5.3mb</code> of a <code>genind</code>, which is ~1.5x larger than the source file. That&#x27;s quite a big difference!</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="summary-statistics">Summary statistics<a aria-hidden="true" class="hash-link" href="#summary-statistics" title="Direct link to heading">​</a></h3><p>The obvious hallmark of population genetics is heterozygosity values and F-statistics. Here we&#x27;ll compare the basic summary statistics that can be produced using <code>hierfstat</code> and <code>PopGen.jl</code>.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_vU9c tabs__item--active">Julia</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">R</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI julia"><pre tabindex="0" class="prism-code language-julia codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">julia&gt; @benchmark summary(sharks, by = &quot;global&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools.Trial:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  memory estimate:  88.42 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate:  1307128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  minimum time:     151.963 ms (0.00% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  median time:      171.484 ms (7.60% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mean time:        172.456 ms (6.08% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  maximum time:     186.606 ms (7.04% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  samples:          29</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  evals/sample:     1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI r"><pre tabindex="0" class="prism-code language-r codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; microbenchmark(basic.stats(gen))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unit: seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             expr      min       lq     mean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> basic.stats(gen) 4.276996 4.425934 4.618796</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   median       uq      max neval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 4.609901 4.706666 5.292831   100</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></div></div><p><img alt="summary statistics plot" src="/PopGen.jl/assets/images/sumstatplot-598f7c700e09791e891c6f574ce057fc.png"></p><p>Comparing averages, PopGen.jl clocks in at ~<code>171ms</code> versus hierfstat&#x27;s <code>4.6s</code>, which is ~<strong>27x</strong> faster on these data. However, when testing on a data that was 401 samples x 5331 loci (not shown), PopGen.jl performed 36.6x faster. This gap seems to increase the larger the data is, but we have not tested the upper limits of this.</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="chi-squared-test-for-hwe">Chi-squared test for HWE<a aria-hidden="true" class="hash-link" href="#chi-squared-test-for-hwe" title="Direct link to heading">​</a></h3><p>This is a classic population genetics test and a relatively simple one. The R benchmark will take a while again, so if you&#x27;re following along, this would be a good time to reconnect with an old friend.</p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_vU9c tabs__item--active">Julia</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">R</li></ul><div class="margin-vert--md"><div role="tabpanel"><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI julia"><pre tabindex="0" class="prism-code language-julia codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">julia&gt; @benchmark hwe_test(sharks)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools.Trial:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  memory estimate:  46.22 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate:  1050525</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  minimum time:     145.476 ms (0.00% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  median time:      179.146 ms (4.35% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mean time:        176.142 ms (3.56% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  maximum time:     204.813 ms (0.00% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  samples:          29</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  evals/sample:     1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI r"><pre tabindex="0" class="prism-code language-r codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; microbenchmark(hw.test(gen, B = 0))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unit: seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                expr      min       lq     mean   median       uq      max neval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> hw.test(gen, B = 0) 5.100298 5.564807 6.265948 5.878842 6.917006 8.815179   100</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></div></div><p><img alt="chi squared plot" src="/PopGen.jl/assets/images/chisqplot-94c0d817b3b77543f63ae472bbde4d6a.png"></p><p>Comparing averages, PopGen.jl clocks in at ~<code>176ms</code> versus adegenet&#x27;s <code>6.3s</code>, so ~<strong>35.8x</strong> faster on these data(!)</p><h3 class="anchor anchorWithHideOnScrollNavbar_3ly5" id="pairwise-fst">Pairwise FST<a aria-hidden="true" class="hash-link" href="#pairwise-fst" title="Direct link to heading">​</a></h3><p>You all know it, you all love it. What&#x27;s population genetics without a little pairwise FST sprinkled in? This benchmark compairs the Weir &amp; Cockerham pairwise FST calculation in <code>PopGen.jl</code> against <code>hierfstat</code></p><div class="tabs-container"><ul role="tablist" aria-orientation="horizontal" class="tabs tabs--block"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_vU9c tabs__item--active">Julia</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">Julia (parallel)</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_vU9c">R</li></ul><div class="margin-vert--md"><div role="tabpanel"><p>We will add the extra keywords <code>samples</code> and <code>seconds</code> to the benchmark
macro so we can get a full 100 evaluations. You will need to start Julia with 1 available threads via <code>julia --threads 1</code> (julia &gt;= v1.5) or <code>JULIA_NUM_THREADS=1</code> (&lt; v1.5).</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI julia"><pre tabindex="0" class="prism-code language-julia codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">julia&gt; @benchmark pairwise_fst(sharks) samples = 100 seconds = 700</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools.Trial: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  memory estimate:  869.93 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate:  6090633</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  minimum time:     557.995 ms (9.29% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  median time:      571.297 ms (11.26% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mean time:        580.627 ms (12.59% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  maximum time:     754.451 ms (31.41% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  samples:          100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  evals/sample:     1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><p>This is to demonstrate what the speed is like when starting Julia with 4 available threads via <code>julia --threads 6</code> (julia &gt;= v1.5) or <code>JULIA_NUM_THREADS=6</code> (&lt; v1.5).</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI julia"><pre tabindex="0" class="prism-code language-julia codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">julia&gt; @benchmark pairwise_fst(sharks) samples = 100 seconds = 700</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BenchmarkTools.Trial: </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  memory estimate:  869.93 MiB</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  allocs estimate:  6090639</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  minimum time:     205.038 ms (0.00% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  median time:      305.189 ms (28.90% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  mean time:        299.227 ms (25.03% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  maximum time:     359.663 ms (27.05% GC)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  samples:          100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  evals/sample:     1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><div role="tabpanel" hidden=""><p>We&#x27;ll need to convert <code>sharks</code> into the matrix/dataframe <code>hierfstat</code> needs
to run this calculation. The conversion will be a separate step so as not
to add unnecessary (or unfair) overhead to the benchmark. This benchmark is
going to take <strong>forever</strong> (200s/run x 100 runs = 5.5hrs), so if you absolutely insist on
trying it out yourself, you may want to pop outside and enjoy some fresh
air for a bit (I ran it overnight). Seriously, you don&#x27;t want to watch this paint dry 🖌️.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI r"><pre tabindex="0" class="prism-code language-r codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">&gt; sharks_hierf &lt;- genind2hierfstat(sharks)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; microbenchmark(pairwise.WCfst(sharks_hierf))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Unit: seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    expr      min       lq     mean   median       uq      max neval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> pairwise.WCfst(sharks2) 192.2786 192.9277 199.4861 193.5743 195.0079 301.6879   100</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div></div></div><p><img alt="pairwise fst plot" src="/PopGen.jl/assets/images/fstplot-6a672cb5538833892ee7eda34c33645a.png"></p><p>On a single thread, pairwise FST in <code>PopGen.jl</code> is <strong>~340x</strong> faster than in <code>hierfstat</code>, and a whopping <strong>665x</strong> faster using 6 threads with the optimized matrix-based implementation.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/BioJulia/PopGen.jl/edit/documentation/docs/gettingstarted/comparison.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-10-28T20:10:05.000Z">10/28/2021</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/PopGen.jl/docs/gettingstarted/tips"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->PopGen.jl tips</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/PopGen.jl/docs/gettingstarted/popdata"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">The PopData type<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#benchmarks" class="table-of-contents__link toc-highlight">Benchmarks</a><ul><li><a href="#reading-in-data" class="table-of-contents__link toc-highlight">Reading in data</a></li><li><a href="#popdata-vs-genind-size" class="table-of-contents__link toc-highlight"><code>PopData</code> vs <code>genind</code> size</a></li><li><a href="#summary-statistics" class="table-of-contents__link toc-highlight">Summary statistics</a></li><li><a href="#chi-squared-test-for-hwe" class="table-of-contents__link toc-highlight">Chi-squared test for HWE</a></li><li><a href="#pairwise-fst" class="table-of-contents__link toc-highlight">Pairwise FST</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Pavel Dimens & Jason Selwyn. Built with Docusaurus. Rawr!</div></div></div></footer></div>
<script src="/PopGen.jl/assets/js/runtime~main.53906080.js"></script>
<script src="/PopGen.jl/assets/js/main.d608e6a1.js"></script>
</body>
</html>